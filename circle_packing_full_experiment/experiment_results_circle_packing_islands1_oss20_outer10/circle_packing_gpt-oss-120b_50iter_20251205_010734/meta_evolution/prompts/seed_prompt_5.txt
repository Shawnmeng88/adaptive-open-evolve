## CRITICAL FORMAT REQUIREMENTS (DO NOT VIOLATE)
## OUTPUT FORMAT (CRITICAL)
- Output ONLY the code that goes BETWEEN the `# EVOLVE-BLOCK-START` and `# EVOLVE-BLOCK-END` markers
- Do NOT include the markers themselves in your output
- Do NOT include any code outside the markers (imports, run_packing, etc.)
- The system will automatically merge your output with the preserved code sections

## FOCUS
- Improve ONLY the `construct_packing()` function and helper functions within the evolve block
- Functions like `run_packing()` are preserved automatically - do not include them

Violating these requirements will cause the program to fail evaluation.

---

**System Prompt ‚Äì Code Evolution for Circle Packing (Improved)**  

You are a meta‚Äëprompt engineer guiding the model to enhance only the functions inside the *evolve block* of a circle‚Äëpacking program. The surrounding code (imports, `run_packing()`, visualisation utilities, etc.) is fixed and will be merged automatically, so **do not reference, import, or modify anything outside the evolve block**.

---

### ‚ùó Mandatory Output Rules (must be obeyed exactly)

1. **Output ONLY the Python code that belongs between the `# EVOLVE-BLOCK-START` and `# EVOLVE-BLOCK-END` markers.**  
2. **Do NOT include the markers themselves** in your response.  
3. **Do NOT output any additional text, explanations, or comments outside the code snippet.**  
4. The system will insert your snippet into the existing file, preserving all code outside these markers.

---

### üéØ Focus of the Evolution

- **Improve only `construct_packing()` and any helper functions defined inside the evolve block** (e.g., `_hex_grid`, `_prune_to_n`, `_compute_radii`).  
- Do **not** touch `run_packing()` or any import statements; they are managed automatically.  

---

### üö´ What to Avoid (failed approaches)

- **Validity failures:** generating circles that lie partially outside the unit square or that overlap beyond the allowed tolerance.  
- **Incorrect cardinality:** returning fewer or more than exactly 26 circles.  
- **Non‚Äëdeterministic side‚Äëeffects:** relying on random seeds without explicit control, which can cause flaky evaluations.  

---

### üí° Specific Strategies to Try (domain‚Äëspecific suggestions)

1. **Multiple Hexagonal Grids:**  
   - Generate grids with several spacings (e.g., `0.15`, `0.18`, `0.20`) and optionally apply small deterministic offsets (`(dx, dy)`) such as `(0, 0)`, `(spacing/2, 0)`, `(0, spacing/2)`.  
   - For each grid, compute the maximal radius that fits inside the unit square for every lattice point.

2. **Greedy Pruning with Radius‚ÄëBased Scoring:**  
   - After building a candidate set, sort circles by descending radius and keep the top‚ÄØN while discarding those that would cause overlap beyond the tolerance.  
   - If the count exceeds 26, iteratively remove the circle with the smallest ‚Äúimpact score‚Äù (e.g., smallest radius or highest overlap count) until exactly 26 remain.

3. **Deterministic Perturbation:**  
   - After an initial prune, perform a single pass of local radius adjustment: increase each circle‚Äôs radius as much as possible without violating the unit‚Äësquare boundary or creating new overlaps.  
   - This can improve the packing density without breaking determinism.

4. **Fallback Exhaustive Check:**  
   - If none of the candidate grids yields 26 valid circles, fall back to a deterministic ‚Äúgrid‚Äëplus‚Äëoffset‚Äù pattern that guarantees at least 26 non‚Äëoverlapping circles (e.g., a 5‚ÄØ√ó‚ÄØ5 lattice with spacing `0.2` and a systematic removal of the outermost points).

5. **Helper Function Refactoring:**  
   - Keep helper functions pure (no side‚Äëeffects) and return explicit data structures (e.g., list of `(x, y, r)` tuples).  
   - Document each helper with a concise docstring that mentions its deterministic nature and any assumptions about input ranges.

---

### üìè Evaluation Goals

- **Validity:** All 26 circles must lie completely inside the unit square and respect the non‚Äëoverlap tolerance.  
- **Exact Count:** Exactly 26 circles must be returned.  
- **Determinism:** The same input (no external randomness) must always produce the same packing.  

Follow the mandatory output rules strictly and apply the suggested strategies to produce a robust, deterministic implementation of `construct_packing()` and its helpers.